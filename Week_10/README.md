# 学习笔记

## 笔记

### RPC 走向服务化

#### 多个相同服务如何管理？

单机性能有限，提供单一服务不能满足高并发的要求，所以需要多个单一服务共同提供服务。

如何将多个相同功能看做一个整体堆外提供服务，引出了分布式与集群的概念

此外，服务从诞生到上线，必然存在多种不同环境并存的情况，有些是面向测试阶段的，有些是面向生产阶段的，如何管理不同环境之间的隔离，多个版本之间的管理，也是分布式系统必须解决的问题，因此有了服务治理的概念

#### 服务的注册发现机制

通过静态的配置文件来管理多个业务以及组成这些业务的物理设备是一件非常恼人的事情。任何一个物理服务器发生了变化（下线，上线)，都可能引起整个集群相关的所有应用的配置文件都需要修改。

那么，如何动态的管理服务间的调用关系，引出了服务注册发现机制。服务调用方依赖不依赖自身的静态配置文件来感知服务提供方，而是通过第三方介入，也就是注册中心来获取提供服务的节点信息，这些节点信息由服务提供方定时向注册中心更新自己的状态，从整体上对client及server进行了解耦。

#### 如何负载均衡，路由等集群功能

集群诞生的本意是为了解决单机性能瓶颈的问题，所以在集群化之后，避免请求都被引导向特定的一台机器上，需要通过负载均衡机制，保障每一台节点尽可能均摊并发压力。

对于服务调用方来说，并不关心具体提供服务的是那一台设备，3台也好5台也好，客户端都只需要同一个接口地址，那么反向代理结合路由功能就可以实现这种需求

#### 熔断，限流等治理能力

短时间内收到大量并发请求，如果不采取任何措施，是极有可能将现有的集群冲垮，不仅已近流入的请求无法流出，新来的请求也无法进入。集群整体处于不可用状态。

熔断机制保障了已经流入的请求可以顺利应当，且在流量高峰期过后，集群不丧失能力。

限流机制将流入的请求进行了限制，细水长流。

#### 心跳，重试等策略

网络抖动时，有可能造成请求失败的状况，如果一旦发生这种状况就立即认为服务不可用是对资源极大的浪费，所以有限次数的重试机制是有必要的。

如果没有心跳机制或者类似的机制，服务不可用的这种情况可能需要等到多次请求失败才会被客户端或者治理方探知。

#### 高可用，监控，性能

集群的管理因设备多，依赖关系复杂变得难以管理，如何从多个节点中定位出现问题的节点就要求了分布式集群必须提供监控能力

### 分布式服务化，SOA， ESB

* ESB: 解决企业级烟囱应用之间，语言异构，数据结构异构的情况下，业务复用的问题，应用之间通过ESB提供的渠道通信
* SOA: 提供了服务之间直连的机制，通过几个中心提供了各个服务之间如何发现对方的机制。相对于ESB,SOA架构提供了更便于服务横向扩展的能力
